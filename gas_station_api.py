import googlemaps
import pprint
import time
import sys
import io

city_list = [
    [1, 'Ankara', '06', '39.92077000', '32.85411000', 4, 1, 25, 50, 0],
    [2, 'İstanbul', '34', '41.00527000', '28.97696000', 1, 1, 25, 50, 0],
    [3, 'Antalya', '07', '36.88414000', '30.70563000', 6, 1, 25, 50, 0],
    [6, 'Elazığ', '23', '38.68096900', '39.22639800', 5, 10, 25, 50, 0],
    [8, 'Adana', '01', '37.00000000', '35.32133330', 6, 1, 25, 50, 0],
    [9, 'Adıyaman', '02', '37.76416670', '38.27616670', 7, 1, 25, 50, 0],
    [10, 'Afyon', '03', '38.76376000', '30.54034000', 3, 1, 25, 50, 0],
    [11, 'Ağrı', '04', '39.72166670', '43.05666670', 5, 1, 25, 50, 0],
    [12, 'Amasya', '05', '40.65000000', '35.83333330', 2, 1, 25, 50, 0],
    [13, 'Artvin', '08', '41.18333330', '41.81666670', 2, 1, 25, 50, 0],
    [14, 'Aydın', '09', '37.84440000', '27.84580000', 3, 1, 25, 50, 0],
    [15, 'Balıkesir', '10', '39.64836900', '27.88261000', 1, 1, 25, 50, 0],
    [17, 'Bilecik', '11', '40.15013100', '29.98306100', 1, 1, 25, 50, 0],
    [17, 'Bingöl', '12', '38.88534900', '40.49829100', 5, 1, 25, 50, 0],
    [18, 'Bitlis', '13', '38.40000000', '42.11666670', 5, 1, 25, 50, 0],
    [19, 'Bolu', '14', '40.73947900', '31.61156100', 2, 1, 25, 50, 0],
    [20, 'Burdur', '15', '37.72690900', '30.28887600', 6, 1, 25, 50, 0],
    [21, 'Bursa', '16', '40.18257000', '29.06687000', 1, 1, 25, 50, 0],
    [22, 'Çanakkale', '17', '40.15531200', '26.41416000', 1, 1, 25, 50, 0],
    [23, 'Çankırı', '18', '40.60000000', '33.61666670', 4, 1, 25, 50, 0],
    [24, 'Çorum', '19', '40.55055560', '34.95555560', 2, 1, 25, 50, 0],
    [25, 'Denizli', '20', '37.773518', '29.087286', 3, 1, 25, 50, 0],
    [26, 'Diyarbakır', '21', '37.91441000', '40.23062900', 7, 1, 25, 50, 0],
    [27, 'Erzincan', '24', '39.75000000', '39.50000000', 5, 1, 25, 50, 0],
    [28, 'Erzurum', '25', '39.90431890', '41.26788530', 5, 1, 25, 50, 0],
    [29, 'Eskişehir', '26', '39.78430200', '30.51922000', 4, 1, 25, 50, 0],
    [30, 'Gaziantep', '27', '37.06622000', '37.38332000', 7, 1, 25, 50, 0],
    [31, 'Giresun', '28', '40.91281100', '38.38953000', 2, 1, 25, 50, 0],
    [32, 'Gümüşhane', '29', '40.46027780', '39.48138890', 2, 1, 25, 50, 0],
    [33, 'Hakkari', '30', '37.58333330', '43.73333330', 7, 1, 25, 50, 0],
    [34, 'Hatay', '31', '36.40184880', '36.34980970', 6, 1, 25, 50, 0],
    [35, 'Isparta', '32', '37.76666670', '30.55000000', 6, 1, 25, 50, 0],
    [36, 'Mersin', '33', '36.80000000', '34.63333330', 6, 1, 25, 50, 0],
    [37, 'İzmir', '35', '38.41885000', '27.12872000', 3, 1, 25, 50, 0],
    [38, 'Kars', '36', '40.59267000', '43.07783100', 5, 1, 25, 50, 0],
    [39, 'Kastamonu', '37', '41.38871000', '33.78273000', 2, 1, 25, 50, 0],
    [40, 'Kayseri', '38', '38.73333330', '35.48333330', 4, 1, 25, 50, 0],
    [41, 'Kırklareli', '39', '41.73333330', '27.21666670', 1, 1, 25, 50, 0],
    [42, 'Kırşehir', '40', '39.15000000', '34.16666670', 4, 1, 25, 50, 0],
    [43, 'Kocaeli', '41', '40.85327040', '29.88152030', 1, 1, 25, 50, 0],
    [44, 'Konya', '42', '37.86666670', '32.48333330', 4, 1, 25, 50, 0],
    [45, 'Kütahya', '43', '39.41666670', '29.98333330', 3, 1, 25, 50, 0],
    [46, 'Malatya', '44', '38.35519000', '38.30946000', 5, 1, 25, 50, 0],
    [47, 'Manisa', '45', '38.61909900', '27.42892100', 3, 1, 25, 50, 0],
    [48, 'Kahramanmaraş', '46', '37.58333330', '36.93333330', 6, 1, 25, 50, 0],
    [49, 'Mardin', '47', '37.31223610', '40.73511200', 7, 1, 25, 50, 0],
    [50, 'Muğla', '48', '37.21527780', '28.36361110', 3, 1, 25, 50, 0],
    [51, 'Muş', '49', '38.74329260', '41.50648230', 5, 1, 25, 50, 0],
    [52, 'Nevşehir', '50', '38.62442000', '34.72396900', 4, 1, 25, 50, 0],
    [53, 'Niğde', '51', '37.96666670', '34.68333330', 4, 1, 25, 50, 0],
    [54, 'Ordu', '52', '40.98333330', '37.88333330', 2, 1, 25, 50, 0],
    [55, 'Rize', '53', '41.02005000', '40.52344900', 2, 1, 25, 50, 0],
    [56, 'Sakarya', '54', '40.75687930', '30.37813800', 1, 1, 25, 50, 0],
    [57, 'Samsun', '55', '41.29278200', '36.33128000', 2, 1, 25, 50, 0],
    [58, 'Siirt', '56', '37.94429000', '41.93288000', 7, 1, 25, 50, 0],
    [59, 'Sinop', '57', '42.02642220', '35.15507450', 2, 1, 25, 50, 0],
    [60, 'Sivas', '58', '39.74766200', '37.01787900', 4, 1, 25, 50, 0],
    [61, 'Tekirdağ', '59', '40.98333330', '27.51666670', 1, 1, 25, 50, 0],
    [62, 'Tokat', '60', '40.31666670', '36.55000000', 2, 1, 25, 50, 0],
    [63, 'Trabzon', '61', '41.00000000', '39.73333330', 2, 1, 25, 50, 0],
    [64, 'Tunceli', '62', '39.10798680', '39.54016720', 5, 1, 25, 50, 0],
    [65, 'Şanlıurfa', '63', '37.15000000', '38.80000000', 7, 1, 25, 50, 0],
    [66, 'Uşak', '64', '38.68230100', '29.40819000', 3, 1, 25, 50, 0],
    [67, 'Van', '65', '38.49416670', '43.38000000', 5, 1, 25, 50, 0],
    [68, 'Yozgat', '66', '39.82000000', '34.80444440', 4, 1, 25, 50, 0],
    [69, 'Zonguldak', '67', '41.45640900', '31.79873100', 2, 1, 25, 50, 0],
    [70, 'Aksaray', '68', '38.36869000', '34.03698000', 4, 1, 25, 50, 0],
    [71, 'Bayburt', '69', '40.25516900', '40.22488000', 2, 1, 25, 50, 0],
    [72, 'Karaman', '70', '37.17593000', '33.22874800', 4, 1, 25, 50, 0],
    [73, 'Kırıkkale', '71', '39.84682100', '33.51525100', 4, 1, 25, 50, 0],
    [74, 'Batman', '72', '37.88116800', '41.13509000', 7, 1, 25, 50, 0],
    [75, 'Şırnak', '73', '37.51638890', '42.46111110', 5, 1, 25, 50, 0],
    [76, 'Bartın', '74', '41.63444440', '32.33750000', 2, 1, 25, 50, 0],
    [77, 'Ardahan', '75', '41.11048100', '42.70217100', 5, 1, 25, 50, 0],
    [78, 'Iğdır', '76', '39.91666670', '44.03333330', 5, 1, 25, 50, 0],
    [79, 'Yalova', '77', '40.65000000', '29.26666670', 1, 1, 25, 50, 0],
    [80, 'Karabük', '78', '41.20000000', '32.63333330', 2, 1, 25, 50, 0],
    [81, 'Kilis', '79', '36.71839900', '37.12122000', 7, 1, 25, 50, 0],
    [82, 'Osmaniye', '80', '37.06805000', '36.26158900', 6, 1, 25, 50, 0],
    [83, 'Düzce', '81', '40.84384900', '31.15654000', 2, 1, 25, 50, 0],
    [84, 'Edirne', '22', '41.66666670', '26.56666670', 1, 1, 25, 50, 0]]
patrol_brand = [[1, 'Aygaz'],

                [2, 'Aytemiz'],

                [3, 'BP Türkiye'],

                [4, 'Energy'],

                [5, 'GO'],

                [6, 'Kadoil'],

                [7, 'Azure Petrol'],

                [8, 'Lukoil'],

                [9, 'Memoil'],

                [10, 'MFD Petrol'],

                [11, 'Milangaz'],

                [12, 'Moil'],

                [13, 'Naspet'],

                [14, 'Opet'],

                [15, 'Petrol Ofisi'],

                [16, 'Qplus'],

                [17, 'Shell Türkiye'],

                [18, 'Siyam Petrolcülük'],

                [19, 'Sunpet'],

                [20, 'Total'],

                [21, 'TP Petrol Dağıtım A.Ş.'],

                [22, 'Diğer']]
tip='hospital'
API_KEY = 'AIzaSyAEOLdqaD0zVdmyDEi37aSIAFI6TSU9l2A'
gmaps = googlemaps.Client(key=API_KEY)
for i in range(len(city_list)):
    city_id = city_list[i][0]
    places_result = gmaps.places_nearby(location="" + city_list[i][3] + "," + city_list[i][4], radius=40000,
                                        open_now=False, type=tip)
    time.sleep(3)
    for j in range((len(places_result['results']))):
        firma_adi = places_result['results'][j]['name']
        lat = places_result['results'][j]['geometry']['location']['lat']
        long = places_result['results'][j]['geometry']['location']['lng']
        if ('vicinity' in places_result['results'][j]):
            adresplus = places_result['results'][j]['vicinity']
        if ('rating' not in places_result['results'][j]):
            rating = 0
            user_rating_total = 0

        else:
            rating = places_result['results'][j]['rating']
            user_rating_total = places_result['results'][j]['user_ratings_total']

        if ('plus_code' in places_result['results'][j]):
            adres = places_result['results'][j]['plus_code']['compound_code']
            adres1 = adres.split(" ")
            pluscode = adres1[0]
            ilce = adres1[1]
            city = adres1[2]
            if (adres[3] == "X"):

                country = "Turkey"
            else:
                country = adres[3]

        alladres = adresplus + ilce + city + country

        firmaadisplit = firma_adi.split("-")
        patrol_id = patrol_brand[-1][0]
        for k in range(len(patrol_brand)):
            if firmaadisplit[0] in patrol_brand[k][1]:
                patrol_id = patrol_brand[k][0]
        with io.open(tip+".txt", "a+", encoding="utf8") as dosya:
            dosya.writelines("('%s' ,'%s' ,%d ,'%g' ,'%g'), \n" % (firma_adi, alladres, city_id, lat, long,patrol_id ))
